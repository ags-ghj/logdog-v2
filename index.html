<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>LogDog ‚Äî If you‚Äôve seen a dog, add it to the log!!!</title>

<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;800&family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0f1418;
  --panel:#141b21;
  --panel-2:#1b242c;
  --ink:#f4efe6;
  --muted:#a7b0b8;
  --accent:#f5a524;
  --stroke:#2a3640;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Space Grotesk",sans-serif;
  color:var(--ink);
  background:
    radial-gradient(800px 400px at 110% -10%, rgba(245,165,36,.15), transparent 60%),
    radial-gradient(600px 400px at -10% 120%, rgba(100,209,166,.12), transparent 60%),
    var(--bg);
}

header{
  padding:18px;
  text-align:center;
  border-bottom:1px solid var(--stroke);
}

header h1{
  font-family:"Fraunces",serif;
  margin:0;
  font-size:26px;
}

header p{
  margin:6px 0 0;
  color:var(--muted);
  font-size:14px;
}

.container{
  max-width:560px;
  margin:0 auto;
  padding:18px;
}

.card{
  background:linear-gradient(180deg,var(--panel),var(--panel-2));
  border:1px solid var(--stroke);
  border-radius:16px;
  padding:18px;
  box-shadow:0 12px 40px rgba(0,0,0,.35);
}

h2{
  font-family:"Fraunces",serif;
  margin:0 0 12px;
}

label{
  display:block;
  margin-top:14px;
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:.08em;
  color:var(--muted);
}

input,select,textarea{
  width:100%;
  margin-top:6px;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:#0f151a;
  color:var(--ink);
  font-size:15px;
}

.count-grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:8px;
  margin-top:6px;
}

.count-btn{
  padding:12px;
  border-radius:10px;
  border:1px solid var(--stroke);
  background:#101820;
  color:var(--ink);
  font-size:16px;
  font-weight:600;
  cursor:pointer;
}

.count-btn.active{
  outline:2px solid var(--accent);
}

button.primary{
  width:100%;
  padding:14px;
  margin-top:18px;
  border-radius:12px;
  border:none;
  font-size:16px;
  font-weight:800;
  background:linear-gradient(120deg,var(--accent),#ffcf5a);
  color:#241600;
  cursor:pointer;
}

.geo-row{
  display:flex;
  gap:8px;
}

.geo-btn{
  flex:0 0 auto;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:#101820;
  color:var(--ink);
  cursor:pointer;
}

hr{
  border:0;
  border-top:1px solid var(--stroke);
  margin:22px 0;
}

.table-wrap{
  overflow-x:auto;
}

table{
  width:100%;
  border-collapse:collapse;
  min-width:520px;
}

th,td{
  padding:10px;
  border-bottom:1px solid var(--stroke);
  font-size:14px;
  white-space:nowrap;
}

th{
  font-size:11px;
  color:var(--muted);
  text-transform:uppercase;
}

img.thumb{
  width:46px;
  height:46px;
  border-radius:8px;
  object-fit:cover;
}

small{
  display:block;
  min-height:18px;
  margin-top:8px;
  color:var(--muted);
}
</style>
</head>

<body>

<header>
  <h1>LogDog üêï</h1>
  <p>If you‚Äôve seen a dog, add it to the log!!!</p>
</header>

<div class="container">
<div class="card">

<h2>New log</h2>

<label>Breed</label>
<select id="breed">
  <option value="">Select breed‚Ä¶</option>
  <option>Labrador</option>
  <option>Golden Retriever</option>
  <option>German Shepherd</option>
  <option>French Bulldog</option>
  <option>Poodle</option>
  <option>Spaniel</option>
  <option>Terrier</option>
  <option value="other">Other‚Ä¶</option>
</select>
<input id="breedOther" placeholder="Enter breed" style="display:none">

<label>Count</label>
<div class="count-grid" id="countGrid">
  <button class="count-btn active" data-count="1">1</button>
  <button class="count-btn" data-count="2">2</button>
  <button class="count-btn" data-count="3">3</button>
  <button class="count-btn" data-count="4">4</button>
  <button class="count-btn" data-count="10">More</button>
</div>
<input id="count" type="hidden" value="1">

<label>Location</label>
<div class="geo-row">
  <input id="location" placeholder="Where?">
  <button type="button" class="geo-btn" id="geoBtn">üìç</button>
</div>

<label>Notes</label>
<textarea id="notes" rows="2"></textarea>

<label>Photo</label>
<input id="photo" type="file" accept="image/*" capture="environment">

<button class="primary" id="submitBtn">Submit</button>
<small id="status"></small>

<hr>

<h2>History</h2>
<div class="table-wrap">
<table>
<thead>
<tr>
  <th>Time</th>
  <th>Breed</th>
  <th>#</th>
  <th>Location</th>
  <th>Notes</th>
  <th>Photo</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>
</div>

</div>
</div>

<script>
const API="https://fn-logdog2-cddwend9gva2gxa8.westeurope-01.azurewebsites.net/api";

const statusEl=document.getElementById("status");
const rowsEl=document.getElementById("rows");
const breedSel=document.getElementById("breed");
const breedOther=document.getElementById("breedOther");
const countInput=document.getElementById("count");
const countGrid=document.getElementById("countGrid");
const locationInput=document.getElementById("location");
const notesInput=document.getElementById("notes");
const photoInput=document.getElementById("photo");

breedSel.onchange=()=>{
  breedOther.style.display = breedSel.value==="other" ? "block":"none";
};

countGrid.onclick=e=>{
  const b=e.target.closest(".count-btn");
  if(!b)return;
  countInput.value=b.dataset.count;
  document.querySelectorAll(".count-btn").forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
};

document.getElementById("geoBtn").onclick=()=>{
  if(!navigator.geolocation){statusEl.textContent="No GPS";return;}
  statusEl.textContent="Getting location‚Ä¶";
  navigator.geolocation.getCurrentPosition(async p=>{
    const {latitude,longitude}=p.coords;
    try{
      const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);
      const d=await r.json();
      locationInput.value=d.address?.suburb||d.address?.town||d.address?.city||`${latitude.toFixed(5)},${longitude.toFixed(5)}`;
      statusEl.textContent="Location added";
    }catch{
      locationInput.value=`${latitude.toFixed(5)},${longitude.toFixed(5)}`;
    }
  },()=>statusEl.textContent="Location denied");
};

document.getElementById("submitBtn").onclick=submitLog;

async function submitLog(){
  statusEl.textContent="Saving‚Ä¶";
  let photoUrl="";
  if(photoInput.files.length){
    const fd=new FormData();
    fd.append("file",photoInput.files[0]);
    photoUrl=await fetch(API+"/upload",{method:"POST",body:fd}).then(r=>r.text());
  }
  await fetch(API+"/submit",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      breed: breedSel.value==="other"?breedOther.value:breedSel.value,
      count:Number(countInput.value),
      location:locationInput.value,
      notes:notesInput.value,
      photoUrl
    })
  });
  statusEl.textContent="Saved";
  locationInput.value=notesInput.value=breedOther.value="";
  loadLogs();
}

async function loadLogs(){
  rowsEl.innerHTML="";
  const data=await fetch(API+"/logs").then(r=>r.json());
  data.forEach(r=>{
    rowsEl.innerHTML+=`
      <tr>
        <td>${r.ts||""}</td>
        <td>${r.breed||""}</td>
        <td>${r.count||""}</td>
        <td>${r.location||""}</td>
        <td>${r.notes||""}</td>
        <td>${r.photoUrl?`<a href="${r.photoUrl}" target="_blank"><img class="thumb" src="${r.photoUrl}"></a>`:""}</td>
      </tr>`;
  });
}
loadLogs();
</script>

</body>
</html>